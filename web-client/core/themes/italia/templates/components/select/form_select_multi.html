<style>
    #{{ key }}.bootstrap-select-wrapper .dropdown.bootstrap-select .btn {
        height: auto;
    }

    #{{ key }}.bootstrap-select-wrapper .dropdown.bootstrap-select.show-tick .filter-option .filter-option-inner-inner .select-pill {
        padding: 4px 4px;
        margin-top: 1px;
    }


    #{{ key }}.bootstrap-select-wrapper .dropdown.bootstrap-select .dropdown-menu[x-placement=top-start] {
        z-index: 20;
        top: calc(-100% - -30px) !important;
        overflow: auto !important;
        width: auto !important;
    }


    #{{ key }}.bootstrap-select-wrapper .dropdown.bootstrap-select .dropdown-menu[x-placement=bottom-start] {
        z-index: 20;
        bottom: calc(-100% - 46px) !important;
        overflow: auto !important;
        width: auto !important;
    }

    #{{ key }}.bootstrap-select-wrapper button .filter-option .filter-option-inner-inner {
        display: flex;
        align-items: center;
        flex-direction: row;
        flex-wrap: wrap;
    }

</style>
<div class="bootstrap-select-wrapper {% if hidden %} d-none {% endif %} {{ customClass }}" id="{{ key }}">
    <label>{{ label }}</label>
    {#    value {{ value }}#}
    <select data-live-search="true" data-boundary="window"
            id="{{ key }}_sel"
            name="{{ key }}_sel"
            data-live-search-placeholder="Sel. "
            {% if required %} required="required" {% endif %}
            {% if disabled %} readonly {% endif %}
            {% if readonly %} readonly {% endif %}
            multiple="true" data-multiple-separator=""
    >

        <option value=""
                {% if value|string == "" %}
                selected
                {% elif readonly or disabled %}
                disabled
                {% endif %} >--
        </option>
        {% for item in options %}

            <option value="{{ item['value'] }}"
                    data-content="<span class='select-pill'><span class='select-pill-text'>{{ item['label'] }}</span></span>"
                    {% if item['value']|string in value %} selected {% endif %}
            ></option>
        {% endfor %}

    </select>
    <script type="text/javascript">
        $("#{{ key }}_sel").selectpicker({
            actionsBox: true
        });

        $("#{{ key }}_sel").off('changed.bs.select', function (e, clickedIndex, isSelected, previousValue) {

            $(this).closest('div').find(".filter-option-inner-inner").addClass("d-flex flex-wrap");
            console.log("#{{ key }}_sel changed.bs.select")


        });


    </script>
</div>
